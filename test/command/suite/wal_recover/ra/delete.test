#$GRN_WAL_ROLE=primary
table_create memos TABLE_NO_KEY
column_create memos count COLUMN_SCALAR UInt32

load --table memos
[
{"count": 10},
{"count": 20},
{"count": 30}
]

#@disable-logging
io_flush
#@copy-path #{db_path}.0000101 #{db_path}.0000101.loaded
#@enable-logging

delete memos --filter "_id<=2"

#@disable-logging
#@copy-path #{db_path}.0000101.wal #{db_path}.0000101.wal.keep
io_flush
#@copy-path #{db_path}.0000101.loaded #{db_path}.0000101
#@enable-logging

#@disable-logging
thread_limit 1
database_unmap
#@copy-path #{db_path}.0000101.wal.keep #{db_path}.0000101.wal
#@enable-logging

select memos

wal_recover

select memos
